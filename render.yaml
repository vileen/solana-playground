services:
  - type: web
    name: solana-snapshot-tool
    env: node
    buildCommand: |
      yarn install
      # List files in current directory for debugging
      ls -la
      # Compile frontend and backend
      npx tsc --skipLibCheck
      npx vite build
      npx tsc --project tsconfig.json --skipLibCheck
      # List files in dist directory for debugging
      mkdir -p dist
      ls -la dist
      if [ -d "dist/backend" ]; then
        ls -la dist/backend
      fi
      # Make the startup script executable
      chmod +x startup.sh
    startCommand: ./startup.sh
    envVars:
      - key: NODE_ENV
        value: production
      - key: NODE_VERSION
        value: 16
      - key: YARN_VERSION
        value: 1.22.19
      - key: SOLANA_RPC_URL
        sync: false
      - key: SOLANA_API_KEY
        sync: false
    disk:
      name: data
      mountPath: /data
      sizeGB: 1 